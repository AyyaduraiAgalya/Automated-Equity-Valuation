# Intrinsic Equity Valuation with Machine Learning: Detecting Mispricing and Alpha from 10-K Reports of U.S. Companies (2009-2025)
### MSc Financial Data Science Dissertation - Agalya Ayyadurai

This repository contains the full data pipeline, modelling code, and research workflow for my dissertation:  
**“Intrinsic Equity Valuation with Machine Learning: Detecting Mispricing and Alpha from 10-K Reports of U.S. Companies (2009-2025)”**

The project investigates whether machine-learning models can estimate intrinsic value from financial statement fundamentals, and whether mispricing signals derived from model residuals can generate long–short trading strategies.

---

## Project Overview

The project is organised around a reproducible data and modelling workflow:

1. **Data Extraction (Bronze–Silver–Gold pipeline)**  
   The `data_extract` module ingests raw SEC EDGAR 10-K financial statement files (ZIP archives) and organises them into a structured bronze–silver–gold layout:
   - **bronze** – raw downloaded files and index metadata as obtained from SEC EDGAR,
   - **silver** – extracted and structured financial statement tables,
   - **gold** – a consolidated annual fundamentals panel at the firm–year level ready to be used by notebooks.

   This architecture is focused on *data extraction and assembly* into a single modelling dataset. Cleaning, exploratory analysis, and modelling are performed in subsequent notebooks.

2. **Dataset Preparation and Exploratory Analysis**  
   Jupyter notebooks load the gold-layer dataset, perform basic sanity checks, construct core variables, and explore the distributional properties of revenues and other key fundamentals.

3. **Mean Reversion and Time-Series Diagnostics**  
   Sector-level revenue growth is analysed using ADF and KPSS tests, AR(1) models, and Ornstein–Uhlenbeck (OU) parameters to assess mean-reversion behaviour across industries.

4. **Feature Engineering and Machine-Learning Modelling**  
   A set of 78 financial features is engineered from the fundamentals panel. Machine-learning models (Linear Regression, Random Forest, Histogram Gradient Boosting) are trained to predict **log market capitalisation**.

5. **Residual-Based Mispricing Strategy and Backtesting**  
   Residuals (actual minus predicted valuation) are used to construct annual long–short portfolios. These strategies are backtested over 2019–2025 to study whether residuals contain useful mispricing information.

---

## Repository Structure

```
.
├── data/
│   ├── bronze/        # Raw SEC filings, ticker mappings
│   ├── silver/        # Transformed financial datasets
│   ├── gold/          # Modelling datasets
│   ├── ml/            # Stored ML-ready data
│   └── report/        # Data extracts used in the dissertation
│
├── notebooks/
│   ├── 01_data_extract.ipynb
│   ├── 02_data_prep.ipynb
│   ├── 03_EDA.ipynb
│   ├── 04_mean_reversion_ar1_ou.ipynb
│   ├── 04_mean_reversion_ar1_Results.ipynb
│   ├── 05_feature_engg.ipynb
│   ├── 06_ML_Modelling.ipynb
│   └── 08_Ticker_Attach_Check.ipynb
│
├── src/
│   ├── data_extract/
│   │   ├── bronze_extractor/
│   │   ├── silver_transformer/
│   │   └── gold_builder/
│   ├── data_enrich/
│   │   ├── annual_financials.py
│   │   ├── ohlcv_to_panel.py
│   │   ├── sic_mapping.py
│   │   └── ticker_mapping.py
│   └── data_model/
│       └── ar1_model.py
│
├── requirements.txt
└── README.md
```

---

## Key Components

### **Notebooks (Main Workflow)**
These notebooks correspond to each stage of the methodology presented in the dissertation:

- **01_data_extract.ipynb** — Loading SEC 10-K datasets, handling zip extractions, ticker mapping  
- **02_data_prep.ipynb** — Cleaning, validation, outlier checks, constructing annual financial panels  
- **04_mean_reversion_ar1_ou.ipynb** — ADF, KPSS, AR(1), OU time-series analysis  
- **05_feature_engg.ipynb** — Construction of 78 financial features  
- **06_ML_Modelling.ipynb** — Model training, tuning, evaluation, residual analysis  

---

## Data Extraction Requirements

Before running the pipeline, you must:

1. Download the SEC 10-K fundamental datasets (ZIP files) from  
   [SEC Financial Statement Data Sets](https://www.sec.gov/data-research/sec-markets-data/financial-statement-data-sets)
2. Place them inside `data/raw/`
3. Follow instructions in **01_data_extract.ipynb**

---

## Reproducibility

All results in the dissertation can be regenerated by extracting adn building the data and running notebooks.

---

## License

This project is released under the MIT License.
